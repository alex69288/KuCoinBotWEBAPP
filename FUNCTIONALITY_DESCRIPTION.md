# Полное описание функционала торгового бота KuCoin v5.0

## Обзор системы

Это комплексный автоматизированный торговый бот для криптовалютной биржи KuCoin. Бот поддерживает несколько торговых стратегий с машинным обучением, Telegram-интерфейс для управления, расширенную аналитику и управление рисками. Бот полностью автоматизирован: после настройки стратегии и запуска, он самостоятельно ведет торговлю на основе сигналов стратегии, открывая позиции при сигнале покупки и закрывая их при достижении take profit или stop loss с учетом комиссий биржи.

## Архитектура системы

### Основные компоненты

1. **Машинное обучение**
   - Random Forest модель для предсказания цен
   - Инженерия признаков для ML

2. **Telegram интеграция**
   - Telegram бот для управления
   - Обработчики команд и callback'ов
   - Меню и клавиатуры

3. **Аналитика и метрики**
   - Сбор и расчет торговых метрик
   - Генерация отчетов

4. **Конфигурация**
   - Менеджер настроек
   - Константы и дефолтные значения

5. **Веб-приложение**
   - Telegram Mini App для управления

## Функциональные возможности

### 1. Торговые стратегии

#### EMA + ML Стратегия
- **Индикаторы**: Быстрая и медленная EMA (настраиваемые периоды)
- **ML компонент**: Random Forest для предсказания направления цены
- **Сигналы**:
  - Покупка: EMA быстрая > медленной + ML уверенность > порога
  - Продажа: Take Profit или Stop Loss (с учетом комиссий)
- **Настройки**:
  - Периоды EMA (fast/slow)
  - Порог EMA кроссовера
  - Пороги уверенности ML для покупки/продажи
  - Take Profit (в %)
  - Stop Loss (в %)
  - Комиссии биржи (в %)
  - Trailing Stop
  - Минимальное время удержания позиции

#### Price Action Стратегия
- Торговля на пробое уровней поддержки/сопротивления
- Анализ свечных паттернов
- Автоматическое закрытие по take profit/stop loss с учетом комиссий

#### MACD + RSI Стратегия
- Комбинация MACD и RSI индикаторов
- Автоматическое открытие по сигналам, закрытие по take profit/stop loss

#### Bollinger Bands Стратегия
- Торговля на пробое полос Боллинджера
- Отскоки от границ канала
- Автоматическое управление позициями

### 2. Управление рисками

- **Дневной лимит потерь**: Ограничение максимальных убытков за день
- **Серия убытков**: Ограничение подряд идущих проигрышных сделок
- **Размер позиции**: Максимальный процент от баланса на одну сделку
- **Волатильность**: Проверка волатильности рынка перед сделкой
- **Минимальные лимиты**: Соблюдение биржевых требований к минимальным объемам
- **Учет комиссий**: Автоматический расчет take profit с учетом комиссий на открытие и закрытие позиций

### 3. Машинное обучение

- **Модель**: Random Forest Classifier
- **Признаки**: Технические индикаторы (EMA, RSI, MACD, Bollinger Bands, объемы)
- **Предсказание**: Вероятность роста/падения цены
- **Уровни уверенности**:
  - >70%: Сильный рост
  - 60-70%: Умеренный рост
  - 50-60%: Нейтрально
  - 40-50%: Умеренное падение
  - <40%: Сильное падение
- **Обучение**: Автоматическое на исторических данных
- **Кэширование**: Сохранение обученной модели

### 2. Управление рисками

- **Дневной лимит потерь**: Ограничение максимальных убытков за день
- **Серия убытков**: Ограничение подряд идущих проигрышных сделок
- **Размер позиции**: Максимальный процент от баланса на одну сделку
- **Волатильность**: Проверка волатильности рынка перед сделкой
- **Минимальные лимиты**: Соблюдение биржевых требований к минимальным объемам

### 3. Машинное обучение

- **Модель**: Random Forest Classifier
- **Признаки**: Технические индикаторы (EMA, RSI, MACD, Bollinger Bands, объемы)
- **Предсказание**: Вероятность роста/падения цены
- **Уровни уверенности**:
  - >70%: Сильный рост
  - 60-70%: Умеренный рост
  - 50-60%: Нейтрально
  - 40-50%: Умеренное падение
  - <40%: Сильное падение
- **Обучение**: Автоматическое на исторических данных
- **Кэширование**: Сохранение обученной модели

### 4. Telegram управление

<!-- #### Основные команды
- `/start` - Главное меню
- Управление торговлей (включить/выключить)
- Выбор стратегии
- Выбор торговой пары
- Настройка параметров стратегии
- Просмотр баланса
- Статистика торговли
- Рыночные данные в реальном времени -->

<!-- #### Inline меню
- Кнопки для быстрого доступа к функциям
- Динамическое обновление информации
- Уведомления о сделках -->

#### Уведомления
- Сигналы о покупке/продаже
- Обновление рыночных данных
- Изменения баланса
- Ошибки и предупреждения

### 5. Аналитика и статистика

#### Метрики торговли
- Общее количество сделок
- Win Rate (процент прибыльных сделок)
- Profit Factor (соотношение прибыли к убыткам)
- Общая прибыль (в % и USDT)
- Максимальная просадка (Drawdown)
- Лучшая/худшая сделка
- Средняя прибыль/убыток
- Серии побед/поражений

#### Отчеты
- Ежедневная статистика
- История сделок
- Производительность по парам
- Анализ стратегий

### 6. Управление позициями

- **Состояние позиции**: Открыта/закрыта, размер, цена входа
- **Сохранение состояния**: Восстановление после перезапуска
- **Множественные позиции**: Поддержка нескольких открытых позиций
- **Цена входа**: Взятие максимальной цены среди всех покупок
- **Размер позиции**: В USDT с учетом комиссий

### 7. Рыночные данные

- **OHLCV данные**: Цена открытия/максимум/минимум/закрытия/объем
- **Технические индикаторы**: EMA, RSI, MACD, Bollinger Bands
- **Таймфреймы**: 1 час (основной), поддержка других
- **Реальное время**: Обновление каждые 30 секунд

### 8. Баланс и средства

- **Баланс аккаунта**: USDT и другие криптовалюты
- **Свободные/замороженные средства**
- **Проверка перед сделкой**: Достаточно ли средств
- **Минимальные суммы**: Соблюдение требований биржи

### 10. Система логирования

- **Уровни логирования**: Info, Error, Debug
- **Файлы логов**: Отдельная директория logs/
- **Форматирование**: Временные метки, уровни, сообщения
- **Консоль**: Вывод в реальном времени

### 11. Конфигурация и настройки

#### Основные настройки
- Включение/выключение торговли
- Процент от баланса на сделку
- Telegram токен и chat ID
- Режим демо/реал

#### Настройки стратегий
- Параметры индикаторов
- Пороги входа/выхода
- Take Profit и Stop Loss

#### Настройки рисков
- Дневной лимит потерь
- Максимальная серия убытков
- Лимит волатильности

#### Настройки ML
- Включение/выключение
- Параметры модели
- Пороги уверенности

### 12. Безопасность и надежность

- **API ключи**: Хранение в .env файле
- **Проверка соединения**: С биржей и Telegram
- **Обработка ошибок**: Graceful degradation
- **Валидация данных**: Проверка входных параметров
- **Лимиты**: Защита от чрезмерной активности

### 13. Поддерживаемые торговые пары

- BTC/USDT
- ETH/USDT
- SOL/USDT
- ADA/USDT
- DOT/USDT
- LINK/USDT

### 14. Режимы работы

#### Реальный режим
- Торговля реальными средствами на KuCoin
- Полная интеграция с API
- Уведомления о сделках

#### Демо режим
- Симуляция торговли без реальных средств
- Полная эмуляция логики
- Тестирование стратегий

## Требования к инфраструктуре

### Системные требования
- Интернет-соединение
- Доступ к API KuCoin

### Настройка
1. Регистрация на KuCoin
2. Создание API ключей
3. Настройка Telegram бота через @BotFather
4. Конфигурация переменных окружения
5. Запуск бота

## Мониторинг и поддержка

### Мониторинг
- Реальное время через Telegram
- Логи работы
- Статистика производительности
- Уведомления о проблемах

### Обновления
- Сохранение настроек между запусками
- Автоматическое восстановление состояния
- Миграция конфигураций

## Расширение системы

### Добавление стратегий
- Создание новых классов стратегий
- Реализация логики расчета сигналов
- Интеграция в систему настроек

### Добавление индикаторов
- Реализация расчетов технических индикаторов
- Интеграция в стратегии

### API интеграции
- REST API для внешних систем
- Webhooks для уведомлений

Этот бот представляет собой полнофункциональную систему algorithmic trading с современными подходами к анализу рынка и управлению рисками.</content>
<parameter name="filePath">c:\Users\user\Documents\Scripts\KuCoinBotV3Cursor\FUNCTIONALITY_DESCRIPTION.md
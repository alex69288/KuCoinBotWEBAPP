# Полное описание функционала торгового бота KuCoin v5.0

## Обзор системы

Это комплексный автоматизированный торговый бот для криптовалютной биржи KuCoin. Бот поддерживает несколько торговых стратегий с машинным обучением, Telegram-интерфейс для управления, расширенную аналитику и управление рисками. Бот полностью автоматизирован: после настройки стратегии и запуска, он самостоятельно ведет торговлю на основе сигналов стратегии, открывая позиции при сигнале покупки и закрывая их при достижении take profit или stop loss с учетом комиссий биржи.

## Архитектура системы

### Основные компоненты

1. **Машинное обучение**
   - Random Forest модель для предсказания цен
   - Инженерия признаков для ML

2. **Telegram интеграция**
   - Telegram бот для управления
   - Обработчики команд и callback'ов
   - Меню и клавиатуры

3. **Аналитика и метрики**
   - Сбор и расчет торговых метрик
   - Генерация отчетов

4. **Конфигурация**
   - Менеджер настроек
   - Константы и дефолтные значения

5. **Веб-приложение**
   - Telegram Mini App для управления

## Функциональные возможности

### 1. Торговые стратегии

#### EMA + ML Стратегия
- **Индикаторы**: Быстрая и медленная EMA (настраиваемые периоды)
- **ML компонент**: Random Forest для предсказания направления цены
- **Сигналы**:
  - Покупка: EMA быстрая > медленной + ML уверенность > порога
  - Продажа: Take Profit или Stop Loss (с учетом комиссий)
- **Настройки**:
  - Периоды EMA (fast/slow)
  - Порог EMA кроссовера
  - Пороги уверенности ML для покупки/продажи
  - Take Profit (в %)
  - Stop Loss (в %)
  - Комиссии биржи (в %)
  - Trailing Stop
  - Минимальное время удержания позиции

#### Price Action Стратегия
- Торговля на пробое уровней поддержки/сопротивления
- Анализ свечных паттернов
- Автоматическое закрытие по take profit/stop loss с учетом комиссий
   - При отображении открытых позиций (в UI и через Telegram), теперь показывается процент до Take Profit с учётом комиссий на покупку и продажу.
      - Цель TP берётся из настроек стратегии (takeProfitPercent).
      - Для пары BTC/USDT комиссия по умолчанию равна 0.1% (на покупку и на продажу).
      - Telegram уведомления показывают также расчётную сумму комиссий в USDT при достижении TP.

#### MACD + RSI Стратегия
- Комбинация MACD и RSI индикаторов
- Автоматическое открытие по сигналам, закрытие по take profit/stop loss

#### Bollinger Bands Стратегия
- Торговля на пробое полос Боллинджера
- Отскоки от границ канала
- Автоматическое управление позициями

### 2. Управление рисками

- **Дневной лимит потерь**: Ограничение максимальных убытков за день
- **Серия убытков**: Ограничение подряд идущих проигрышных сделок
- **Размер позиции**: Максимальный процент от баланса на одну сделку
- **Волатильность**: Проверка волатильности рынка перед сделкой
- **Минимальные лимиты**: Соблюдение биржевых требований к минимальным объемам
- **Учет комиссий**: Автоматический расчет take profit с учетом комиссий на открытие и закрытие позиций

### 3. Машинное обучение

ML (Machine Learning) - это машинное обучение, которое обучается на исторических данных для предсказания вероятности роста или падения цены на основе технических индикаторов.

- **Модель**: Random Forest Classifier
- **Признаки**: Технические индикаторы (EMA, RSI, MACD, Bollinger Bands, объемы)
- **Предсказание**: Вероятность роста/падения цены
- **Уровни уверенности**:
  - >70%: Сильный рост
  - 60-70%: Умеренный рост
  - 50-60%: Нейтрально
  - 40-50%: Умеренное падение
  - <40%: Сильное падение
- **Обучение**: Автоматическое на исторических данных
- **Кэширование**: Сохранение обученной модели

... (контент сохранён, см. оригинал в корне проекта)
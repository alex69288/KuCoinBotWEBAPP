# Changelog
## [v0.0.54] - 2025-11-16
- Удалены корневые shell-скрипты: `run-local.sh`, `run-server.sh`, `start-dev.sh`, `start-production.sh`.
- Удалены `start-with-delay.sh` из `backend/` и из `frontend/` (заменены inline командами в `docker-compose.yml`).
- Удалён `jest.setup.ts` (используется `jest.setup.js`).
- Удалён корневой файл описания `FUNCTIONALITY_DESCRIPTION.md` (перенесён в `docs/FUNCTIONALITY_DESCRIPTION.md`).

## [v0.0.53] - 2025-11-16
- Перенесён `FUNCTIONALITY_DESCRIPTION.md` в папку `docs/`.
- Удалены дублирующие root-скрипты для запуска на Linux/macOS (используется Windows): `run-local.sh`, `run-server.sh`, `start-dev.sh`, `start-production.sh`.
- Удалён дублирующий `jest.setup.ts` (используется `jest.setup.js`).
 - Удалены `start-with-delay.sh` в `backend/` и `frontend/` — теперь `docker-compose.yml` использует inline `sh -c` команды.

## [v0.0.50] - 2025-11-16
- Изменена логика отображения статусов ML — теперь строки статусов соответствуют уровням уверенности (>70% — Сильный рост, 60-70% — Умеренный рост, 50-60% — Нейтрально, 40-50% — Умеренное падение, <40% — Сильное падение). Модель по-прежнему возвращает числовую вероятность.

## [v0.0.51] - 2025-11-16
- Исправлен ML predictor: восстановлен возврат числовой уверенности (0..1). Обновлены стратегии и UI для отображения меток на основе процентов.

## [v0.0.52] - 2025-11-16
- UI/Telegram: Показываем `До Take Profit` (в %) для открытой позиции с учётом комиссий; цель берётся из настроек стратегии.
- Добавлён расчёт требуемой цены Take Profit c учётом комиссий на покупку и продажу (по умолчанию 0.1% для пары BTC/USDT).
- Telegram: добавлен расчёт примерной суммы комиссий (в USDT) при достижении TP и отображается в уведомлениях.

## [v0.0.49] - 2025-11-16
- Добавлено описание ML как машинного обучения, которое обучается на исторических данных.

## [v0.0.48] - 2025-11-16
- Изменен ML predictor для использования вероятностей вместо бинарных предсказаний, чтобы уровни уверенности соответствовали описанию (>70% сильный рост и т.д.).

## [v0.0.47] - 2025-11-16
- Добавлена инвалидация кэша ['marketUpdate'] и ['botConfig'] в toggleDemoMode мутации для обновления UI после переключения демо-режима.

## [v0.0.46] - 2025-11-16
- Исправлен синтаксис try-catch-finally в start-dev.ps1: объединен } и finally на одну строку для корректного парсинга PowerShell.

## [v0.0.45] - 2025-11-16
- Исправлен синтаксис try-catch-finally в start-dev.ps1: разделен } и catch на разные строки для корректного парсинга PowerShell.

## [v0.0.44] - 2025-11-16
- Исправлен синтаксис try-catch-finally в start-dev.ps1: разделен } и finally на разные строки для корректного парсинга PowerShell.

## [v0.0.43] - 2025-11-16
- Добавлен exit 0 в start-dev.ps1 для предотвращения запроса подтверждения завершения пакетного файла.

## [v0.0.42] - 2025-11-16
- Исправлен watch-backend.ps1: добавлен $CurrentProcessId = $PID и замена $PID на $CurrentProcessId в Free-Port для избежания ошибки с read-only переменной.

## [v0.0.41] - 2025-11-16
- Добавлен goto :eof в конце start-dev.bat для предотвращения запроса подтверждения при завершении.

## [v0.0.40] - 2025-11-16
- Изменен start-dev.bat для запуска PowerShell-контроллера в том же окне, чтобы ждать Ctrl+C для остановки backend и frontend.

## [v0.0.39] - 2025-11-16
- Изменен start-dev.bat для запуска только двух cmd окон: одного для backend (watch-backend.ps1) и одного для frontend (npm run dev). Убран PowerShell-контроллер. Также убран pause в start-production.bat для автоматического завершения.

## [v0.0.38] - 2025-11-16
- Добавлен наблюдатель `backend/watch-backend.ps1` для перезапуска backend при изменениях в `backend/src`.
- Перед каждым рестартом watcher освобождает порт `8080` (убивает процессы, слушающие порт), чтобы избежать конфликтов при биндинге.
- Обновлён `start-dev.ps1` и `start-dev.bat`: теперь контроллер запускается в текущем терминале, frontend и backend открываются в двух окнах; Ctrl+C в контроллере сразу выполняет корректную остановку без запроса Y/N.
- Обновлён `backend/src/core/bot.ts`: использование singleton `kucoinService()` вместо прямого `new KuCoinService()` и слияние восстановленных позиций с вручную добавленными (чтобы не затирать manual positions).
- Добавлены логгирование в `getMarketUpdate()` для отладки позиций и усовершенствована логика `restorePositions()` (merge вместо overwrite).

## [v0.0.32] - 2025-11-16
- Исправлен баг: вертикальная прокрутка была активна в области верхнего меню. Заменён `overflow-y` на `overflow-x` в селекторе `[data-testid="top-tabs-wrapper"]` в `frontend/src/index.css`.


## [v0.0.31] - 2025-11-16
- Исправлен скролл на вкладке статус: убрал min-height: 100vh для .gray-container, чтобы контейнер адаптировался по размеру контента без принудительного скролла

## [v0.0.30] - 2025-11-16
- Исправлена высота страницы: добавлен min-height: 100vh для html, body, #root и .gray-container, чтобы страница адаптировалась по размеру контента с минимумом 100vh

## [v0.0.29] - 2025-11-16
- Исправлена проблема с вертикальной прокруткой: убрал overflow: hidden для html, body, #root и position: fixed для .menu, .top-tabs-wrapper, .top-tabs-outer, .gray-container, чтобы разрешить скролл всей страницы

## [v0.0.25] - 2025-11-16
- Добавлено overflow: visible к классу .mySwiper для предотвращения обрезания контента при переходах между вкладками

## [v0.0.24] - 2025-11-16
- Проведены тесты после исправления бага с обрезанием контента: все тесты пройдены успешно (15 suites, 70 tests passed)

## [v0.0.22] - 2025-11-16
- Исправлен баг с обрезанием контента во время скрола между вкладками: добавлен плавный переход высоты (transition) и overflow: visible для swiper-wrapper

## [v0.0.21] - 2025-11-16
- Исправлен баг с обрезанием панелей при скролле между вкладками: убрана flex-grow на контейнере Swiper, чтобы высота подстраивалась корректно под контент каждого слайда

## [v0.0.20] - 2025-11-16
- Исправлено поведение высоты страницы: контейнер теперь имеет минимальную высоту экрана (min-height: 100vh), но растягивается по размеру контента, если контент больше экрана

## [v0.0.19] - 2025-11-16
- Изменена высота страницы: контейнер теперь всегда занимает полную высоту экрана (100vh), независимо от размера контента, для лучшего визуального восприятия на экранах с малым количеством контента

## [v0.0.18] - 2025-11-15
- Добавлена проверка наличия KuCoin API credentials перед вызовом аутентифицированных методов, предотвращающая ошибки аутентификации при отсутствии ключей

## [v0.0.17] - 2025-11-15
- Убран дублирующий корневой `.env` и предпочтение отдано `backend/.env` для backend и `frontend/.env` для frontend
- Обновлены скрипты запуска (`start-production.sh`, `start-production.bat`) для использования `backend/.env` и `frontend/.env` с обратной совместимостью для корневого `.env`
- Добавлен `.gitignore` для игнорирования `.env` файлов и удалены реальные ключи из индекса
- Исправлена проверка загрузки env в `backend/src/index.ts` (предпочтение `backend/.env`), и маршруты загружаются после dotenv

## [v0.0.18] - 2025-11-15
- Исправлен поведение верхнего меню: добавлена горизонтальная прокрутка для вкладок на маленьких экранах (`overflow-x-auto` & `whitespace-nowrap`).
- Добавлена вертикальная прокрутка для основной области интерфейса (`overflow-y-auto`), чтобы контент не выходил за пределы экрана.

## [v0.0.15] - 2025-11-15
- Добавлен пакет protobufjs в зависимости backend для исправления ошибки модуля при запуске dev сервера

## [v0.0.14] - 2025-11-15
- Исправлен порт backend в скриптах запуска: убрана установка PORT=5000, теперь используется значение из .env (8000)

## [v0.0.13] - 2025-11-15
- Исправлены проблемы с запуском backend: изменен порт на 8000, добавлен пропуск ML тренировки в dev, отключен Telegram бот в dev, добавлены timeouts для Redis и API

## [v0.0.12] - 2025-11-15
- Убраны дублированные заголовки "KuCoin Trading Bot" из интерфейса TradingInterface.tsx

## [v0.0.11] - 2025-11-15

## [v0.0.22] - 2025-11-15
- UI: Fixed 24h change percent rounding and added equivalent USDT value on Market Update panel
- ML: Fix RandomForest predictor output range (0..1) to avoid inflated percent display in ML card
- UI: Added "View positions" button and modal showing detailed open positions
## [v0.0.10] - 2025-11-15
- Исправлена синтаксическая ошибка в graceful shutdown handlers
- Добавлена задержка 5 секунд перед запуском сервера для предотвращения конфликтов Telegram polling

## [v0.0.9] - 2025-11-15
- Исправлена ошибка конфликта Telegram polling при перезапуске в режиме разработки: добавлен graceful shutdown для SIGINT и SIGTERM
- Синхронизированы порты: backend на 5000, frontend на 3000 в скриптах запуска
- Исправлен CORS origin для правильного порта frontend

## [v0.0.8] - 2025-11-15
- Реорганизован интерфейс на вкладки: Главная (обновление рынка, сигналы, позиции, статистика), Статус (управление ботом), Аккаунт (баланс), История (ордеры и сделки), Настройки (стратегия и демо режим)
- Переведены названия на русский: "Обновление рынка", "Сигнал", "Открытые позиции"
- Добавлена статистика по сделкам на главной странице: Всего сделок, Прибыльные, Убыточные, Общий P&L
- Исправлена проблема с запуском backend в Docker: добавлена проверка наличия TELEGRAM_BOT_TOKEN перед инициализацией бота, чтобы избежать ошибок в dev среде

## [v0.0.6] - 2025-11-15
- Изменен дизайн обновления рынка: теперь отображается в виде карточек с цветами и иконками, согласованно со стилем сайта
- Изменен API getMarketUpdateMessage на getMarketUpdate, возвращающий объект вместо строки
- Обновлены переводы в i18n для новых элементов интерфейса

## [v0.0.1] - 2025-11-15
- Добавлена функция обновления рынка в реальном времени
- Добавлена команда /market в Telegram бота для получения информации о рынке
- Добавлен маршрут /api/bot/market-update для получения обновления рынка
- Обновлен frontend для отображения обновления рынка
- Добавлена поддержка EMA, сигналов стратегии, ML предсказаний и позиций в обновлении рынка

## [v0.0.19] - 2025-11-15
- Исправлены ошибки сборки frontend: удалены лишние JSX-фрагменты в `TradingInterface.tsx`.
- Устранены TypeScript ошибки при тестировании: заменены использования `import.meta.env` на runtime-safe проверки, добавлен `vite/client` в `tests/tsconfig.json`.
- Добавлены моки для `swiper/react` и стилей в Jest, чтобы тесты корректно работали в среде Node.
- Установлены тестовые зависимости `@tanstack/react-query` и `@testing-library/jest-dom` при необходимости для корректного выполнения тестов.

## [v0.0.20] - 2025-11-15
- Добавлен `ErrorBoundary` чтобы отображать читаемую информацию об ошибке вместо белого экрана в случае runtime исключений.
- Добавлена документация `docs/FRONTEND_DEBUG.md` с краткими инструкциями по отладке белого экрана и указанием возможной смены порта Vite (например, 3000 -> 3001).

## [v0.0.21] - 2025-11-15
- Исправлена ошибка "ReferenceError: process is not defined" на фронтенде — теперь `VITE_API_URL` вычисляется безопасно (prefers `window` then `process.env`), и `import.meta.env` используется через `index.html` injection для Vite.
- Добавлен runtime-injection `window.VITE_API_URL` в `frontend/index.html` чтобы избегать `import.meta` ссылок в коде (устранение проблем с Jest).

## [v0.0.23] - 2025-11-15
- UI: Убраны горизонтальные отступы у главного контейнера (`p-4` -> `pt-4 pb-6`) — теперь контент прилегает к краям экрана по X, а отступ снизу 24px обеспечивает пространство после последнего блока.
- UI: Увеличен gap между горизонтальными карточками до 24px (`gap-6`) для единообразного интервала между блоками.
- Docs: Обновлена `docs/SCROLLING.md` с описанием изменений в скролле и отступах.

## [v0.0.24] - 2025-11-15
- UI: Добавлен универсальный вертикальный отступ в 24px для логических блоков (`.page-block`) — теперь все карточки и блоки на странице имеют одинаковое расстояние друг от друга.
- UI: Исправлена высота страниц — контейнеры теперь подстраиваются по контенту, убран `min-h-screen`, чтобы избежать большого пустого пространства внизу страниц.
- UI: Убрана серая полоса/трек у горизонтальной прокрутки верхнего меню (`top-tabs-wrapper`) — добавлены кроссбраузерные CSS правила для скрытия трека scrollbars.

## [v0.0.25] - 2025-11-16
- UI: Поднята серая граница под верхним меню на 24px — border сдвинут визуально вверх без воздействия на сам контент (используется отрицательный отступ и компенсация padding).
- UI: У каждого логического блока (`.page-block`) добавлены 12px внешних отступов по бокам (margin-left и margin-right).
- UI: Исправлена высота страниц — контейнер `page-container` больше не использует внутренний скролл, теперь он подстраивается под контент (удалён `overflow-y-auto` через CSS override).
- UI: Улучшение: поднятие бордера верхних вкладок теперь реализовано через `::after` псевдо-элемент (позиционирование `absolute; bottom: 24px`) — это предотвращает layout shift при scroll и совместимо с тестами.

## [v0.0.26] - 2025-11-16
- UI: Исправлена горизонтальная подсветка: серая полоса под меню теперь не прокручивается с вкладками и рисуется на внешнем обёртке (`.top-tabs-outer`), чтобы оставаться на месте при горизонтальном скролле.
- UI: У блоков обновлён внешний отступ: `margin: 0px 12px 24px 12px` (верх 0, справа 12, снизу 24, слева 12).
- UI: Уменьшен нижний отступ в верхних вкладках для уменьшения пустого пространства (mb-6 -> mb-4); добавлены CSS-исправления для `Swiper` (слайды подстраиваются по контенту: `.mySwiper .swiper-slide { height:auto; }`), чтобы убрать лишний вертикальный скролл на странице "Статус".